### Python 中的深拷贝、浅拷贝和赋值

Python中的变量都是对象了，存储的都是**引用语义**而不是值语义，更加灵活和抽象，但是**不可复制**，也就是说，每个变量都是实际变量的地址，相当于都是指针。

> ```
> 引用语义：在python中，变量保存的是对象(值)的引用，我们称为引用语义。采用这种方式，变量所需的存储空间大小一致，因为变量只是保存了一个引用。也被称为对象语义和指针语义。
> 值语义：有些语言采用的不是这种方式，它们把变量的值直接保存在变量的存储区里，这种方式被我们称为值语义，例如C语言，采用这种存储方式，每一个变量在内存中所占的空间就要根据变量实际的大小而定，无法固定下来。
> 值语义和引用语义的区别：
> 值语义：   死的、 傻的、 简单的、 具体的、 可复制的
> 引用语义： 活的、 聪明的、 复杂的、 抽象的、 不可复制的
> ```

![](F:\MD本地图片\python通用编程课程\第一节_用户交互\第三章数据类型\python变量存储方式.png)



***在python中的数据类型包括：bool、int、long、float、str、set、list、tuple、dict等等。我们可以大致将这些数据类型归类为简单数据类型和复杂的数据结构。***

```python
# 数据结构及其划分依据
# 我的划分标准是，如果一个数据类型，可以将其他的数据类型作为自己的元素，我就认为这是一种数据结构。数据结构的分类有很多种，但是在Python中常用的只有集合、序列和映射三种结构。对应python中的set、list(tuple、str)、dict；常用的数据类型有int、long、float、bool、str等类型。（其中，str类型比较特别，因为从C语言的角度来说，str其实是一个char的集合，但是这与本文的关联不大，所以我们暂时不谈这个问题）
```

### 1、 数据类型重新初始化对python语义引用的影响

```python
str1 = 'aaa'
str1 = 'bbb'
'''
在这个重新初始化的过程，相当于改变了str1指针指向的地址，原来的内存地址不再指向
'''
```

### 2、 数据结构内部元素变化对python语意引用的影响

***对列表或者其他复杂的数据结构进行增删改，不会改变此数据结构的内存地址，只会改变相应元素对应内存的存放值，***但是重新赋值（初始化）就会改变原来的地址，对它进行了覆盖



#### 关于string的赋值：

```python
str1 = 'hello world'
str2 = str1		#注意，这里相当于指针，就是str2指向str1所指向的内存地址
#给str1重新赋值，改变了它指向的地址，但是原地址的内容还在，str2仍旧指向原地址，所以str2不会跟随str1改变
```

#### 关于复杂数据结构的赋值：

```python
list1 = [1,2,3]
list2 = list1
#此时，list1和list2的id一样，即是指向相同的内存地址
list1.append('new item')
#注意，此时list2也跟随了list1的变化
#因为复杂数据结构增删改不会改变它的id，没有新开辟内存地址，在原有的地址上的改变
#所以同时引起了指向此地址的list2的改变
```

***对于复杂数据结构，赋值会完全共享，一定要慎用，因为一个值的改变同时会引起另一个值跟随变化***

#### 复杂数据结构的浅拷贝：

```python
import copy
sourceLst = [1,2,3，list0]
copyLst = copy.copy(sourceLst)
#特点：
#相当于创建了sourceLst的副本，id不同，改变sourceLst中的普通元素不会导致copyLst跟随变化，反之亦然，不会互相跟随
#但是需要注意，如果改变list0中的某个元素，sourceLst和copyLst都会发生变化
```

***这种情况发生在字典套字典、列表套字典、字典套列表，列表套列表，以及各种复杂数据结构的嵌套中，所以当我们的数据类型很复杂的时候，用copy去进行浅拷贝就要非常小心***



#### 复杂数据结构的深拷贝：

**深拷贝就是拷贝的值与之前的源不再有任何的关系**,改变其中的嵌套内容也不会导致deepcopy的变化

```python
import copy
list0 = [4,5,6]
sourceLst = [1,2,3，list0]
deepcopyLst = copy.deepcopy(sourceLst)
```



